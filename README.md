# Telegram Бот для образовательных центров

Telegram-бот для поиска образовательных центров, покупки абонементов и управления посещениями через QR-коды.

## 🚀 Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка

Создайте файл `.env`:
```
BOT_TOKEN=your_bot_token_here
DATABASE_PATH=database.db
ADMIN_IDS=your_telegram_id

# Настройки AirbaPay (опционально)
AIRBA_PAY_BASE_URL=https://ps.airbapay.kz/acquiring-api
AIRBA_PAY_USER=your_airba_user
AIRBA_PAY_PASSWORD=your_airba_password
AIRBA_PAY_TERMINAL_ID=your_terminal_id
AIRBA_PAY_COMPANY_ID=230140022645
AIRBA_PAY_WEBHOOK_URL=https://your-domain.com
```

**Примечание:** Если платежная система не настроена, бот будет работать без оплаты (абонементы создаются сразу).

### 3. Запуск

```bash
python main.py
```

## 📋 Функциональность

### Для пользователя:
- 📚 Каталог курсов с фильтрацией
- 🎫 Покупка абонементов с QR-кодами
- 📊 Статистика посещений
- 🕒 Расписание занятий

### Для родителя:
- 👶 Добавление детей
- 🎫 Покупка абонементов для детей
- 📊 Отслеживание посещаемости

### Для ребёнка:
- 📷 Показ QR-кода
- 🕒 Расписание
- 📊 Статистика

### Для партнёра:
- 🏢 Регистрация центра
- 🧾 Сканирование QR-кодов
- 📊 Аналитика

### Для админа:
- ✅ Модерация центров
- 👥 Управление пользователями
- 📊 Аналитика системы

## 📁 Структура проекта

```
.
├── main.py              # Точка входа
├── config.py            # Конфигурация
├── database.py         # База данных
├── requirements.txt     # Зависимости
├── handlers/            # Обработчики
│   ├── common.py
│   ├── user.py
│   ├── parent.py
│   ├── child.py
│   ├── partner.py
│   └── admin.py
├── middleware/          # Middleware
│   ├── error_handler.py
│   └── logging.py
├── services/            # Сервисы
│   └── payment.py       # Платежный сервис AirbaPay
└── utils/               # Утилиты
    ├── keyboards.py
    ├── qr_generator.py
    ├── validators.py
    └── pagination.py
```

## 🛠 Команды

- `/start` - Начать работу
- `/partner` - Регистрация центра
- `/admin` - Админ-панель
- `/cancel` - Отменить операцию

## 💳 Платежная система

Бот интегрирован с **AirbaPay** для обработки платежей:
- Создание платежей при покупке абонементов
- Проверка статуса платежей
- История платежей пользователя
- Возвраты платежей

Если платежная система не настроена, бот работает в режиме без оплаты (абонементы создаются сразу).

## 📝 Примечания

- База данных создаётся автоматически
- QR-коды требуют установки Pillow (опционально)
- Логи сохраняются в `bot.log`
- Платежная система AirbaPay опциональна

## 📄 Лицензия

MIT
